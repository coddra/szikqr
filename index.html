<!DOCTYPE html>
<html lang="hu">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta property="og:title" content="SZIK-es QR-kód generátor">
  <meta property="og:description" content="Generálj QR-kódokat SZIK-es logóval vagy anélkül - gyorsan és egyszerűen.">
  <meta property="og:image" content="https://szikqr.pages.dev/preview.png">
  <meta property="og:url" content="https://szikqr.pages.dev/">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="hu_HU">

  <title>SZIK-es QR-kód generátor</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    #qrCodeDisplay img {
      max-width: 100%;
      height: auto;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>

<body class="min-h-screen bg-gradient-to-br from-purple-600 to-blue-500 flex items-center justify-center p-4">
  <div class="bg-white rounded-xl shadow-2xl p-8 w-full max-w-md">
    <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">
      SZIK-es és nem SZIK-es QR-kód generátor
    </h1>

    <div class="mb-6">
      <label for="qr-content" class="block text-gray-700 text-sm font-semibold mb-2">
        URL vagy szöveg:
      </label>
      <input type="text" name="qr-code-content" id="qr-content" value=""
        placeholder="https://example.com" autocomplete="off"
        class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 text-gray-800" />
    </div>

    <div class="flex items-center mb-4">
      <input id="includeLogo" type="checkbox" class="mr-2" checked>
      <label for="includeLogo" class="text-sm text-gray-700">Logó megjelenítése</label>
    </div>

    <button type="submit" id="generateButton"
      class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-400 disabled:opacity-50 disabled:cursor-not-allowed">
      QR-kód generálása
    </button>

    <div id="errorMessage" class="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm hidden">
    </div>

    <div id="qrCodeDisplay" class="mt-8 text-center hidden">
      <h2 class="text-xl font-semibold text-gray-800 mb-4">Íme a QR-kód:</h2>
      <div id="qr-code" class="flex justify-center"></div>
      <p class="mt-4 text-sm text-gray-600">
        Mentéshez jobbklikk a QR-kódra
      </p>
    </div>
  </div>
</body>

<script>
  const qrContentInput = document.getElementById("qr-content");
  const generateButton = document.getElementById("generateButton");
  const qrCodeDisplay = document.getElementById("qrCodeDisplay");
  const errorMessage = document.getElementById('errorMessage');
  const logoCheckbox = document.getElementById('includeLogo');
  const qrContainer = document.getElementById('qr-code');

  const logoMatrix = [
    [0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,2,1,1,2,2,0,0,0,0,0,0],
    [0,0,0,2,2,2,1,1,1,1,2,2,0,0,0,0,0],
    [0,0,0,2,1,1,1,1,1,1,1,2,2,0,0,0,0],
    [0,0,2,2,2,1,1,1,1,1,1,1,2,2,0,0,0],
    [0,0,2,1,1,1,1,1,1,1,1,1,1,2,0,0,0],
    [0,2,2,2,1,1,2,1,1,1,1,1,2,2,2,0,0],
    [0,2,1,1,1,1,1,1,1,1,1,1,1,1,2,2,0],
    [2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,2,0],
    [2,1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,0],
    [2,2,1,1,2,2,1,1,1,1,1,1,1,1,1,2,0],
    [0,2,2,1,1,1,1,1,1,1,1,1,1,1,2,2,0],
    [0,2,1,1,1,2,2,2,2,1,1,1,1,2,2,0,0],
    [0,2,2,2,2,2,1,2,1,1,2,2,2,2,0,0,0],
    [0,0,0,0,0,2,1,1,1,1,2,0,0,0,0,0,0],
    [0,0,0,0,0,2,1,1,1,1,2,0,0,0,0,0,0],
    [0,0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0]
  ];

  function showErrorMessage(message) {
    errorMessage.textContent = message;
    errorMessage.classList.remove('hidden');
    qrCodeDisplay.classList.add('hidden');
  }

  function hideErrorMessage() {
    errorMessage.classList.add('hidden');
    errorMessage.textContent = '';
  }

  function generateQrCode(qrContent) {
    hideErrorMessage();

    qrContent = qrContent.trim();
    let includeLogo = logoCheckbox.checked;

    if (!qrContent) {
      showErrorMessage('Írj be egy URL-t vagy szöveget a generáláshoz!');
      return;
    }

    generateButton.textContent = 'Generálás...';
    generateButton.disabled = true;

    qrContainer.innerHTML = '';
    try {
      const tempDiv = document.createElement('div');
      qrContainer.appendChild(tempDiv);

      const tempQr = new QRCode(tempDiv, {
        text: qrContent,
        width: 256,
        height: 256,
        colorDark: '#000000',
        colorLight: '#ffffff',
        correctLevel: QRCode.CorrectLevel.H,
      });

      setTimeout(() => {
        const imgTag = tempDiv.querySelector('img');
        if (!imgTag) return;

        const canvas = document.createElement('canvas');
        canvas.width = 256;
        canvas.height = 256;
        const ctx = canvas.getContext('2d');

        const qrImg = new Image();
        qrImg.src = imgTag.src;
        qrImg.onload = () => {
          ctx.drawImage(qrImg, 0, 0, 256, 256);

          if (includeLogo) {
            const moduleCount = tempQr._oQRCode.moduleCount;
            const moduleSize = 256 / moduleCount;
            const treeSize = logoMatrix.length;
            const startX = Math.floor((moduleCount - treeSize) / 2);
            const startY = startX;

            function drawPixels(color, pixel) {
              ctx.fillStyle = color;
              ctx.imageSmoothingEnabled = false;
              const ps = Math.ceil(moduleSize);
              for (let y = 0; y < treeSize; y++) {
                for (let x = 0; x < treeSize; x++) {
                  if (logoMatrix[y][x] == pixel) {
                    const px = Math.floor((startX + x) * moduleSize);
                    const py = Math.floor((startY + y) * moduleSize);
                    ctx.fillRect(px, py, ps, ps);
                  }
                }
              }
            }

            drawPixels('#b7182e', 1);
            drawPixels('#ffffff', 2);
          }

          // Replace old image
          qrContainer.innerHTML = "";
          const finalImg = new Image();
          finalImg.src = canvas.toDataURL();
          qrContainer.appendChild(finalImg);
          qrCodeDisplay.classList.remove('hidden');
        };
      }, 100);
    } catch (err) {
      showErrorMessage(`Probléma akadt a QR-kód generálásakor: ${err.message || 'ismeretlen probléma'}`);
      console.error('Error generating QR code:', err);
    } finally {
      generateButton.textContent = 'QR-kód generálása';
      generateButton.disabled = false;
    }
  }

  window.onload = function () {
    generateQrCode("https://www.szentignac.hu");
  };

  generateButton.addEventListener("click", function () {
    let qrContent = qrContentInput.value;

    generateQrCode(qrContent);
  });

  qrContentInput.addEventListener('keypress', function (event) {
    if (event.key === 'Enter') {
      event.preventDefault();
      generateButton.click();
    }
  });
</script>

</html>
